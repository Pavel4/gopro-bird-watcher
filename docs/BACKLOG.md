# Backlog

Известные проблемы, ограничения и планы на будущее.

---

## Известные проблемы

### [BUG] macOS: черные интервалы 5-10 секунд в начале видео

**Платформа:** macOS (AVFoundation)
**Описание:** В начале записанного видео могут появляться черные кадры длительностью 5-10 секунд.
**Причина:** AVFoundation на macOS не поддерживает сегментацию в реальном времени, используется режим прямой записи с вырезкой по времени (`-ss` / `-t`). Смещение при вырезке может захватывать интервал до начала реального видеопотока.
**Воспроизведение:** Запустить детектор, вызвать движение через 10-15 сек после старта. Открыть сохраненное видео.
**Приоритет:** Средний

### [BUG] macOS: иногда битые фрагменты внутри видео

**Платформа:** macOS (AVFoundation)
**Описание:** Внутри видео могут встречаться короткие артефакты (глитчи, замирания).
**Причина:** Прямая запись через FFmpeg + AVFoundation иногда дает сбои при высокой нагрузке на CPU.
**Приоритет:** Низкий

### [LIMITATION] macOS: нет pre-buffer (буфера до начала движения)

**Платформа:** macOS (AVFoundation)
**Описание:** На macOS запись начинается с момента детекции движения, а не за N секунд до него.
**Причина:** AVFoundation не поддерживает FFmpeg сегментацию (`-f segment`). На Linux/Raspberry Pi сегментация работает и pre-buffer доступен.
**Обходной путь:** Нет. Ограничение платформы.
**Приоритет:** Низкий (на целевой платформе Raspberry Pi работает корректно)

### [IMPROVEMENT] FFmpeg: улучшить логику перезапуска

**Описание:** FFmpeg может зависнуть после 20 неудачных попыток перезапуска. Нет механизма уведомления пользователя.
**Решение:** Добавить Telegram-уведомление при критических ошибках FFmpeg и более умную стратегию перезапуска (exponential backoff).
**Приоритет:** Средний

---

## Планируемые фичи

### [FEATURE] ML-модель для распознавания видов птиц

Интегрировать модель машинного обучения для автоматической классификации видов птиц на видео. Добавить название вида в caption Telegram-уведомления.

### [FEATURE] Веб-интерфейс для просмотра записей

Простой веб-интерфейс (Flask/FastAPI) для:
- Просмотра последних записей
- Просмотра статистики
- Управления детектором (вкл/выкл, настройки)

### [FEATURE] Статистика посещений кормушки

Сбор и визуализация данных:
- Количество визитов в день/неделю
- Распределение по времени суток
- Средняя длительность визита
- Экспорт в CSV

### [FEATURE] Интерактивный выбор ROI через GUI

Добавить графический интерфейс для выбора области интереса (Region of Interest) на кадре с камеры, вместо ручного указания координат в конфиге.

### [FEATURE] Мониторинг состояния камеры

- Уровень заряда батареи GoPro
- Температура камеры
- Параметры текущего потока
- Telegram-уведомления при проблемах с камерой
