# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram –ë–æ—Ç–∞

Telegram –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤–∏–¥–µ–æ –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –ø—Ç–∏—Ü –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.

## –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞

### 1. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram –∏ –Ω–∞–π–¥–∏—Ç–µ **@BotFather**
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/newbot`
3. –í–≤–µ–¥–∏—Ç–µ –∏–º—è –±–æ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: "GoPro Bird Watcher")
4. –í–≤–µ–¥–∏—Ç–µ username (–Ω–∞–ø—Ä–∏–º–µ—Ä: "gopro_bird_watcher_bot")
5. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω** (–≤–∏–¥–∞: `123456789:ABCdefGHIjklMNOpqrsTUVwxyz`)

### 2. –ü–æ–ª—É—á–∏—Ç–µ Chat ID

**–°–ø–æ—Å–æ–± 1 - —á–µ—Ä–µ–∑ @userinfobot:**
1. –ù–∞–π–¥–∏—Ç–µ –≤ Telegram **@userinfobot**
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`
3. –ë–æ—Ç –ø—Ä–∏—à–ª–µ—Ç –≤–∞—à **User ID** (—ç—Ç–æ –∏ –µ—Å—Ç—å Chat ID)

**–°–ø–æ—Å–æ–± 2 - —á–µ—Ä–µ–∑ API:**
1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤–∞—à–µ–º—É –±–æ—Ç—É
2. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
   ```
   https://api.telegram.org/bot<–í–ê–®_–¢–û–ö–ï–ù>/getUpdates
   ```
3. –ù–∞–π–¥–∏—Ç–µ `"chat":{"id":123456789}` - —ç—Ç–æ –≤–∞—à Chat ID

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–í `config.env` –∏–ª–∏ `config.pi.env`:

```env
# –í–∫–ª—é—á–∏—Ç—å Telegram –±–æ—Ç–∞
TELEGRAM_ENABLED=true

# –¢–æ–∫–µ–Ω –æ—Ç @BotFather
TELEGRAM_BOT_TOKEN=123456789:ABCdefGHIjklMNOpqrsTUVwxyz

# –í–∞—à Chat ID
TELEGRAM_CHAT_ID=123456789

# –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤–∏–¥–µ–æ –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –¥–≤–∏–∂–µ–Ω–∏—è
TELEGRAM_SEND_ON_MOTION=true

# –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤–∏–¥–µ–æ –ø—Ä–∏ —Ä—É—á–Ω–æ–π –∑–∞–ø–∏—Å–∏
TELEGRAM_SEND_MANUAL=false

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –≤–∏–¥–µ–æ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ (MB)
# –ë–æ–ª—å—à–µ - –±—É–¥–µ—Ç —Å–∂–∞—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
TELEGRAM_MAX_VIDEO_MB=45
```

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

–û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É –≤ Telegram:

- `/start` - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
- `/status` - –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã (FPS, –¥–∏—Å–∫, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)
- `/latest` - –ü–æ—Å–ª–µ–¥–Ω–∏–µ 5 –∑–∞–ø–∏—Å–µ–π
- `/help` - –°–ø—Ä–∞–≤–∫–∞

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–ö–æ–≥–¥–∞ –≤–∫–ª—é—á–µ–Ω–æ `TELEGRAM_SEND_ON_MOTION=true`:

- –ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –ø—Ç–∏—Ü—ã ‚Üí **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤–∏–¥–µ–æ**
- –ï—Å–ª–∏ –≤–∏–¥–µ–æ > 50MB ‚Üí **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∂–∏–º–∞–µ—Ç—Å—è**
- Caption —Å–æ–¥–µ—Ä–∂–∏—Ç: timestamp, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–∏–¥–µ–æ

–ü—Ä–∏–º–µ—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:
```
üê¶ –ü—Ç–∏—Ü–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞!
2026-02-03 14:30:15
–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 2m 15s

[–≤–∏–¥–µ–æ]
```

## –°–∂–∞—Ç–∏–µ –≤–∏–¥–µ–æ

–ï—Å–ª–∏ –≤–∏–¥–µ–æ –±–æ–ª—å—à–µ `TELEGRAM_MAX_VIDEO_MB`:

1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å–∂–∞—Ç–∞—è –≤–µ—Ä—Å–∏—è —á–µ—Ä–µ–∑ FFmpeg
2. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: CRF 28, –±–∏—Ç—Ä–µ–π—Ç –∞—É–¥–∏–æ 96k
3. –û–±—ã—á–Ω–æ —Ä–∞–∑–º–µ—Ä —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –≤ 2-3 —Ä–∞–∑–∞
4. –ö–∞—á–µ—Å—Ç–≤–æ –æ—Å—Ç–∞–µ—Ç—Å—è —Ö–æ—Ä–æ—à–∏–º –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç –±–æ—Ç–∞

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install aiogram==3.24.0

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
export TELEGRAM_BOT_TOKEN='–≤–∞—à_—Ç–æ–∫–µ–Ω'
export TELEGRAM_CHAT_ID='–≤–∞—à_chat_id'

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –±–æ—Ç
python detector/telegram_bot.py
```

–û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start` –±–æ—Ç—É –≤ Telegram –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏.

### –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤–∏–¥–µ–æ

–°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –≤–∏–¥–µ–æ:

```python
import asyncio
from telegram_bot import TelegramNotifier

async def test():
    bot = TelegramNotifier(
        bot_token="–≤–∞—à_—Ç–æ–∫–µ–Ω",
        chat_id="–≤–∞—à_chat_id",
        max_video_mb=45.0
    )
    
    # –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ –≤–∏–¥–µ–æ
    await bot.send_video(
        "recordings/motion/bird_20260203_143015_2m15s.mp4",
        caption="üê¶ –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤–∏–¥–µ–æ"
    )
    
    await bot.close()

asyncio.run(test())
```

## Troubleshooting

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—ã

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω: –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω?
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω (–ª–æ–≥–∏ –¥–µ—Ç–µ–∫—Ç–æ—Ä–∞ –¥–æ–ª–∂–Ω—ã –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å "Telegram bot polling...")
3. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ `TELEGRAM_ENABLED=true`

### –í–∏–¥–µ–æ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Chat ID
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–º–µ—Ä –≤–∏–¥–µ–æ: `ls -lh recordings/motion/`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
   ```bash
   grep -i telegram logs/motion_detector.log
   ```

### –û—à–∏–±–∫–∞ "Failed to send video"

1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ FFmpeg —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: `which ffmpeg`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª—É –≤–∏–¥–µ–æ
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç (–≤—ã—à–µ)

### –í–∏–¥–µ–æ —Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ —Å–∂–∏–º–∞–µ—Ç—Å—è

–ù–∞ Raspberry Pi —Å–∂–∞—Ç–∏–µ –º–æ–∂–µ—Ç –∑–∞–Ω–∏–º–∞—Ç—å –≤—Ä–µ–º—è:
- 1080p 2min –≤–∏–¥–µ–æ ‚Üí ~30-60 —Å–µ–∫—É–Ω–¥ —Å–∂–∞—Ç–∏—è
- 720p 2min –≤–∏–¥–µ–æ ‚Üí ~15-30 —Å–µ–∫—É–Ω–¥

**–†–µ—à–µ–Ω–∏—è:**
- –°–Ω–∏–∑—å—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ: `USB_RESOLUTION=720`
- –£–≤–µ–ª–∏—á—å—Ç–µ –ª–∏–º–∏—Ç: `TELEGRAM_MAX_VIDEO_MB=50`
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ SSD –≤–º–µ—Å—Ç–æ SD –∫–∞—Ä—Ç—ã

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**–í–ê–ñ–ù–û:**
- **–ù–µ –ø—É–±–ª–∏–∫—É–π—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞** –≤ –∫–æ–¥–µ –∏–ª–∏ Git
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ù–µ –¥–µ–ª–∏—Ç–µ—Å—å Chat ID
- –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –±–æ—Ç–∞ —á–µ—Ä–µ–∑ @BotFather

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Telegram Bot API](https://core.telegram.org/bots/api)
- [aiogram 3.x –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://docs.aiogram.dev/)
- [@BotFather](https://t.me/BotFather) - —Å–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–æ–≤
- [@userinfobot](https://t.me/userinfobot) - —É–∑–Ω–∞—Ç—å Chat ID

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

–ë–æ—Ç –±—É–¥–µ—Ç –ø—Ä–∏—Å—ã–ª–∞—Ç—å –≤–∏–¥–µ–æ –∫–∞–∂–¥—ã–π —Ä–∞–∑ –∫–æ–≥–¥–∞ –ø—Ç–∏—Ü–∞ –ø—Ä–∏–ª–µ—Ç–∞–µ—Ç –∫ –∫–æ—Ä–º—É—à–∫–µ.

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –¥–µ–Ω—å

–û—Ç–ø—Ä–∞–≤—å—Ç–µ `/status` –≤–µ—á–µ—Ä–æ–º —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –±—ã–ª–∏ –ø—Ç–∏—Ü—ã.

### –ê—Ä—Ö–∏–≤ –∑–∞–ø–∏—Å–µ–π

–û—Ç–ø—Ä–∞–≤—å—Ç–µ `/latest` —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è.
